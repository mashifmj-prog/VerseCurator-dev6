<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VerseCurator - Bible Verse App</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light Theme Variables */
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --text-light: #95a5a6;
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #ecf0f1;
            --card-bg: #ffffff;
            --border-color: #e9ecef;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.15);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .dark-mode {
            --primary-color: #8b9dc3;
            --secondary-color: #3b5998;
            --accent-color: #dfe3ee;
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
            --text-light: #95a5a6;
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #0f3460;
            --card-bg: #1e2a47;
            --border-color: #2c3e50;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.4);
            --gradient: linear-gradient(135deg, #8b9dc3 0%, #3b5998 100%);
        }

        /* Base Styles */
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            line-height: 1.6;
            font-size: 14px;
        }

        .app-container {
            min-height: 100vh;
            background: var(--bg-primary);
            padding-bottom: 2rem;
        }

        /* Rate Button Styles */
        .rate-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: var(--shadow-hover);
            z-index: 1000;
            transition: all 0.3s ease;
            display: none;
        }

        .rate-button.pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(102, 126, 234, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(102, 126, 234, 0);
            }
        }

        .rate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        /* Rating Modal Styles */
        .rating-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .rating-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow-hover);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }

        .rating-stars {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .rating-star {
            font-size: 2.5em;
            color: #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .rating-star:hover,
        .rating-star.active {
            color: #ffd700;
            transform: scale(1.2);
        }

        .rating-comment {
            width: 100%;
            height: 80px;
            margin: 15px 0;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            resize: none;
            font-family: inherit;
        }

        .rating-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .rating-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .rating-submit {
            background: var(--gradient);
            color: white;
        }

        .rating-cancel {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .rating-btn:hover {
            transform: translateY(-2px);
        }

        /* Warning Modal Styles */
        .warning-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .warning-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow-hover);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }

        .warning-icon {
            font-size: 3rem;
            color: #ffa500;
            margin-bottom: 1rem;
        }

        .warning-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 1.5rem;
        }

        .warning-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .warning-primary {
            background: var(--gradient);
            color: white;
        }

        .warning-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .warning-outline {
            background: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-primary);
        }

        /* Theme Selection Styles */
        .theme-selection {
            margin: 20px 0;
        }

        .theme-options {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .theme-options label {
            font-weight: 600;
            color: var(--text-primary);
        }

        .theme-options select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
        }

        .theme-preview {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
            background: #f0f0f0;
        }

        .theme-preview canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }

        .image-actions {
            display: flex;
            gap: 10px;
        }

        .share-action-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: var(--gradient);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .share-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .share-action-btn:active {
            transform: translateY(0);
        }

        /* Schedule Modal Styles */
        .schedule-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .schedule-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow-hover);
            max-width: 400px;
            width: 90%;
        }

        .schedule-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .schedule-option {
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .schedule-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .schedule-option.active {
            border-color: var(--primary-color);
            background: var(--gradient);
            color: white;
        }

        .custom-time {
            margin-top: 15px;
        }

        .time-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: inherit;
        }

        /* Mobile-First Header */
        .app-header {
            background: var(--gradient);
            color: white;
            padding: 1rem;
            position: relative;
            overflow: hidden;
        }

        .header-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            flex-shrink: 0;
        }

        .logo i {
            font-size: 1.5rem;
            color: white;
        }

        .title-group h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            line-height: 1.2;
        }

        .title-group .app-tagline {
            font-size: 0.75rem;
            opacity: 0.9;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            flex-shrink: 0;
        }

        .theme-toggle .fa-sun {
            display: none;
        }

        .dark-mode .theme-toggle .fa-moon {
            display: none;
        }

        .dark-mode .theme-toggle .fa-sun {
            display: block;
        }

        .theme-toggle i {
            font-size: 1.1rem;
            color: white;
        }

        .time-display {
            display: none;
        }

        /* Mode Indicator */
        .mode-indicator {
            background: rgba(255, 255, 255, 0.15);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 0.5rem;
            display: inline-block;
            backdrop-filter: blur(10px);
        }

        .mode-indicator.auto {
            background: rgba(255, 255, 255, 0.2);
        }

        .mode-indicator.manual {
            background: rgba(255, 215, 0, 0.3);
            color: #ffd700;
        }

        .countdown {
            font-size: 0.7rem;
            opacity: 0.8;
            margin-left: 0.5rem;
        }

        /* Mobile Time Period Indicator */
        .time-period-indicator {
            position: relative;
            z-index: 2;
            margin: 1rem 0 0;
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .time-period-indicator::-webkit-scrollbar {
            display: none;
        }

        .period {
            flex: 0 0 auto;
            text-align: center;
            padding: 0.75rem 0.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.7;
            min-width: 80px;
        }

        .period.active {
            background: rgba(255, 255, 255, 0.2);
            opacity: 1;
            transform: scale(1.05);
        }

        .period i {
            font-size: 1.25rem;
            margin-bottom: 0.25rem;
            display: block;
        }

        .period span {
            display: block;
            font-weight: 600;
            font-size: 0.8rem;
            margin-bottom: 0.125rem;
        }

        .period small {
            font-size: 0.65rem;
            opacity: 0.8;
        }

        /* Main Content - Mobile Optimized */
        .app-main {
            padding: 1rem;
        }

        /* Control Panel - Mobile Stack */
        .control-panel {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .panel-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .control-label {
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .control-label i {
            color: var(--primary-color);
            width: 20px;
            font-size: 0.9rem;
        }

        .control-select {
            padding: 0.875rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            width: 100%;
        }

        .occasion-settings {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        /* Verse Section - Mobile Optimized */
        .verse-section {
            margin-bottom: 1.5rem;
        }

        .verse-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2rem 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .verse-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .verse-header {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .verse-time-badge,
        .verse-translation-badge {
            padding: 0.5rem 0.875rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            background: var(--gradient);
            color: white;
        }

        .verse-translation-badge {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .verse-text {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            font-style: italic;
            font-weight: 500;
        }

        .verse-reference {
            font-size: 1.1rem;
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .verse-actions {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
        }

        .action-btn {
            background: var(--bg-tertiary);
            border: none;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }

        /* Action Buttons - Mobile Full Width */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .action-buttons-row {
            display: flex;
            gap: 0.75rem;
        }

        .action-buttons-row .btn {
            flex: 1;
        }

        .btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 14px;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-decoration: none;
            width: 100%;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        /* Stats Section - Mobile Grid */
        .stats-section {
            margin-bottom: 1.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 1.5rem 1rem;
            border-radius: 16px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.75rem;
        }

        .stat-icon i {
            font-size: 1.25rem;
            color: white;
        }

        .stat-number {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.8rem;
        }

        /* Custom Section - Mobile Optimized */
        .custom-section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .section-header {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .section-header h3 {
            font-size: 1.25rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .custom-form {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .form-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-input {
            padding: 0.875rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            resize: vertical;
            width: 100%;
        }

        .custom-verses-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .custom-verse-item {
            background: var(--bg-secondary);
            padding: 1.25rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .verse-content {
            flex: 1;
        }

        .verse-content strong {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .verse-meta {
            display: flex;
            gap: 0.75rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
            flex-wrap: wrap;
        }

        .delete-verse {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        /* Share Type Selection */
        .share-type-selection {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            justify-content: center;
        }

        .share-type-btn {
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            flex: 1;
            text-align: center;
        }

        .share-type-btn.active {
            background: var(--gradient);
            color: white;
            border-color: transparent;
        }

        /* Enhanced share options - FIXED DARK MODE CONTRAST */
        .share-with-link .share-icon {
            position: relative;
        }

        .share-with-link .share-icon::after {
            content: '🔗';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 0.7rem;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* FIXED: Dark mode share modal text contrast */
        .dark-mode .share-option span {
            color: #ffffff !important;
        }

        .dark-mode .share-type-btn {
            color: #e0e0e0;
        }

        .dark-mode .share-type-btn.active {
            color: #ffffff;
        }

        .dark-mode .theme-options label {
            color: #ffffff;
        }

        .dark-mode .theme-options select {
            color: #ffffff;
            background: var(--bg-secondary);
        }

        .dark-mode .theme-options select option {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        /* Modal Styles - Mobile Full Screen */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 20px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
            border: 1px solid var(--border-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 1.5rem 1rem;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            background: var(--card-bg);
            border-radius: 20px 20px 0 0;
        }

        .modal-header h3 {
            font-size: 1.25rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.25rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
        }

        .modal-body {
            padding: 1.5rem;
        }

        /* Share Options - Mobile Grid */
        .share-options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .share-option {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1.25rem 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .share-icon {
            width: 44px;
            height: 44px;
            background: var(--bg-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .share-icon i {
            font-size: 1.25rem;
        }

        .share-option span {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-primary); /* Ensures proper contrast */
        }

        .share-option.device-share {
            background: var(--gradient);
            color: white;
            border-color: transparent;
            grid-column: span 2;
        }

        .share-option.device-share span {
            color: white; /* White text for device share button */
        }

        /* Note Modal */
        .note-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            resize: vertical;
            min-height: 120px;
        }

        .modal-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            left: 1rem;
            background: #2ecc71;
            color: white;
            padding: 1rem 1.25rem;
            border-radius: 8px;
            z-index: 1001;
            box-shadow: var(--shadow-hover);
            font-weight: 600;
            animation: slideIn 0.3s ease;
            text-align: center;
        }

        .notification.error {
            background: #e74c3c;
        }

        .notification.info {
            background: #3498db;
        }

        @keyframes slideIn {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(-100%); opacity: 0; }
        }

        /* === NEW ENHANCEMENTS CSS === */
        
        /* Collapsible Sections */
        .collapsible-section {
            margin-bottom: 1.5rem;
        }

        .collapsible-btn {
            width: 100%;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 14px;
            padding: 1.25rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }

        .collapsible-btn:hover {
            background: var(--bg-secondary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .collapsible-btn i:last-child {
            transition: transform 0.3s ease;
        }

        .collapsible-btn.active i:last-child {
            transform: rotate(180deg);
        }

        .collapsible-content {
            display: none;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 14px 14px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        /* Share History Styles */
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .history-content {
            flex: 1;
        }

        .history-verse {
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .history-details {
            display: flex;
            gap: 1rem;
            color: var(--text-secondary);
            font-size: 0.75rem;
            flex-wrap: wrap;
        }

        .history-platform {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .history-actions {
            display: flex;
            gap: 0.5rem;
        }

        .history-action-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .history-action-btn:hover {
            background: var(--bg-tertiary);
        }

        .empty-history {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        /* WhatsApp Broadcast Styles */
        .broadcast-section {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .broadcast-steps {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .broadcast-step {
            display: flex;
            gap: 1rem;
        }

        .step-number {
            width: 30px;
            height: 30px;
            background: var(--gradient);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-content h4 {
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .step-content p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 0.75rem;
        }

        .copy-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-btn:hover {
            background: var(--bg-primary);
        }

        .copy-btn.success {
            background: #2ecc71;
            color: white;
            border-color: #2ecc71;
        }

        .contacts-section {
            margin-top: 1.5rem;
        }

        .contacts-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .contact-item {
            background: var(--bg-primary);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .contact-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .contact-avatar {
            width: 40px;
            height: 40px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .contact-details h4 {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .contact-details p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .contact-actions {
            display: flex;
            gap: 0.5rem;
        }

        .contact-action-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .contact-action-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .empty-contacts {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        /* Reminder Management Styles */
        .reminder-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .reminder-item {
            background: var(--bg-secondary);
            padding: 1.25rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .reminder-content {
            flex: 1;
        }

        .reminder-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .reminder-details {
            display: flex;
            gap: 1rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
            flex-wrap: wrap;
        }

        .reminder-actions {
            display: flex;
            gap: 0.5rem;
        }

        .reminder-action-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .reminder-action-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .reminder-action-btn.delete:hover {
            background: #e74c3c;
            color: white;
        }

        .empty-reminders {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        /* Responsive Design - Tablet and Desktop */
        @media (min-width: 768px) {
            .app-container {
                max-width: 1200px;
                margin: 0 auto;
            }
            
            .app-header {
                padding: 1.5rem;
            }
            
            .title-group h1 {
                font-size: 2rem;
            }
            
            .title-group .app-tagline {
                font-size: 0.85rem;
            }
            
            .time-display {
                display: block;
                font-size: 0.9rem;
                opacity: 0.9;
            }
            
            .time-period-indicator {
                justify-content: center;
            }
            
            .period {
                min-width: 100px;
            }
            
            .panel-grid {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .control-group {
                flex: 1;
                min-width: 200px;
            }
            
            .action-buttons {
                flex-direction: row;
            }
            
            .action-buttons-row {
                flex: 1;
            }
            
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .share-options-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .share-option.device-share {
                grid-column: span 1;
            }
            
            .broadcast-steps {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .broadcast-step {
                flex: 1;
                min-width: 250px;
                flex-direction: column;
            }
            
            .step-number {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
            
            .modal-content {
                max-width: 600px;
            }
        }

        @media (min-width: 1024px) {
            .app-main {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
                padding: 1.5rem;
            }
            
            .verse-section {
                grid-column: 1 / -1;
            }
            
            .stats-section {
                grid-column: 1 / -1;
            }
            
            .custom-section {
                grid-column: 1 / -1;
            }
            
            .collapsible-section {
                grid-column: 1 / -1;
            }
        }
    </style>
</head>
<body class="dark-mode">
    <div class="app-container">
        <!-- Rate Button -->
        <button class="rate-button pulse" id="rateButton">
            <i class="fas fa-star"></i> Rate VerseCurator
        </button>

        <!-- Rating Modal -->
        <div class="rating-modal" id="ratingModal">
            <div class="rating-content">
                <h3>Rate VerseCurator</h3>
                <p>How would you rate your experience with VerseCurator?</p>
                <div class="rating-stars">
                    <span class="rating-star" data-rating="1">★</span>
                    <span class="rating-star" data-rating="2">★</span>
                    <span class="rating-star" data-rating="3">★</span>
                    <span class="rating-star" data-rating="4">★</span>
                    <span class="rating-star" data-rating="5">★</span>
                </div>
                <textarea class="rating-comment" placeholder="Optional: Share your feedback..."></textarea>
                <div class="rating-actions">
                    <button class="rating-btn rating-cancel" id="ratingCancel">Cancel</button>
                    <button class="rating-btn rating-submit" id="ratingSubmit">Submit Rating</button>
                </div>
            </div>
        </div>

        <!-- Warning Modal -->
        <div class="warning-modal" id="warningModal">
            <div class="warning-content">
                <div class="warning-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3>Important Notice</h3>
                <p>This is a demo version of VerseCurator. Some features may be limited in functionality.</p>
                <div class="warning-actions">
                    <button class="warning-btn warning-primary" id="warningContinue">Continue</button>
                    <button class="warning-btn warning-outline" id="warningLearnMore">Learn More</button>
                </div>
            </div>
        </div>

        <!-- Schedule Modal -->
        <div class="schedule-modal" id="scheduleModal">
            <div class="schedule-content">
                <h3>Schedule Verse Display</h3>
                <p>Choose when to display this verse:</p>
                <div class="schedule-options">
                    <div class="schedule-option" data-time="now">Now</div>
                    <div class="schedule-option" data-time="morning">Morning (5AM-12PM)</div>
                    <div class="schedule-option" data-time="afternoon">Afternoon (12PM-6PM)</div>
                    <div class="schedule-option" data-time="evening">Evening (6PM-10PM)</div>
                    <div class="schedule-option" data-time="night">Night (10PM-5AM)</div>
                    <div class="schedule-option" data-time="custom">Custom Time</div>
                </div>
                <div class="custom-time" id="customTimeInput" style="display: none;">
                    <input type="time" class="time-input" id="customTime">
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="scheduleCancel">Cancel</button>
                    <button class="btn btn-primary" id="scheduleConfirm">Confirm</button>
                </div>
            </div>
        </div>

        <!-- Theme Selection Modal -->
        <div class="modal" id="themeModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-palette"></i> Theme Selection</h3>
                    <button class="modal-close" id="themeModalClose">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="theme-selection">
                        <div class="theme-options">
                            <label for="themeSelect">Select Theme:</label>
                            <select id="themeSelect">
                                <option value="classic">Classic</option>
                                <option value="modern">Modern</option>
                                <option value="minimal">Minimal</option>
                                <option value="serene">Serene</option>
                            </select>
                        </div>
                        <div class="theme-preview">
                            <canvas id="themePreview" width="400" height="200"></canvas>
                        </div>
                        <div class="image-actions">
                            <button class="share-action-btn" id="applyTheme">
                                <i class="fas fa-check"></i> Apply Theme
                            </button>
                            <button class="share-action-btn" id="saveThemeImage">
                                <i class="fas fa-download"></i> Save as Image
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- App Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">
                        <i class="fas fa-book-bible"></i>
                    </div>
                    <div class="title-group">
                        <h1>VerseCurator</h1>
                        <div class="app-tagline">Curate • Share • Inspire</div>
                        <div class="mode-indicator auto">
                            <i class="fas fa-magic"></i> Auto - <span id="currentTimePeriod">🌙 Night</span>
                            <span class="countdown" id="countdown">(Next: 5:00 AM)</span>
                        </div>
                    </div>
                </div>
                <div class="header-controls">
                    <div class="time-display" id="currentTime">10:45 PM</div>
                    <div class="theme-toggle" id="themeToggle">
                        <i class="fas fa-moon"></i>
                        <i class="fas fa-sun"></i>
                    </div>
                </div>
            </div>
            
            <!-- Time Period Indicator -->
            <div class="time-period-indicator">
                <div class="period active" data-period="morning">
                    <i class="fas fa-sun"></i>
                    <span>Morning</span>
                    <small>5AM-12PM</small>
                </div>
                <div class="period" data-period="day">
                    <i class="fas fa-cloud-sun"></i>
                    <span>Day</span>
                    <small>12PM-3PM</small>
                </div>
                <div class="period" data-period="afternoon">
                    <i class="fas fa-sun"></i>
                    <span>Afternoon</span>
                    <small>3PM-6PM</small>
                </div>
                <div class="period" data-period="evening">
                    <i class="fas fa-cloud-moon"></i>
                    <span>Evening</span>
                    <small>6PM-10PM</small>
                </div>
                <div class="period" data-period="night">
                    <i class="fas fa-moon"></i>
                    <span>Night</span>
                    <small>10PM-5AM</small>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Control Panel -->
            <section class="control-panel">
                <div class="panel-grid">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-language"></i>
                            <span>Translation</span>
                        </div>
                        <select class="control-select" id="translationSelect">
                            <option value="ESV">ESV</option>
                            <option value="NIV">NIV</option>
                            <option value="KJV">KJV</option>
                            <option value="NKJV">NKJV</option>
                            <option value="NASB">NASB</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-desktop"></i>
                            <span>Display Mode</span>
                        </div>
                        <select class="control-select" id="displayModeSelect">
                            <option value="auto">Auto (Time-based)</option>
                            <option value="manual">Manual</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-paint-brush"></i>
                            <span>Canvas Style</span>
                        </div>
                        <select class="control-select" id="canvasStyleSelect">
                            <option value="classic">Classic</option>
                            <option value="modern">Modern</option>
                            <option value="minimal">Minimal</option>
                            <option value="serene">Serene</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-cog"></i>
                            <span>App Mode</span>
                        </div>
                        <select class="control-select" id="appModeSelect">
                            <option value="general">General</option>
                            <option value="devotional">Devotional</option>
                            <option value="study">Study</option>
                            <option value="outreach">Outreach</option>
                        </select>
                    </div>
                </div>
                <div class="occasion-settings">
                    <div class="control-label">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Occasion Settings</span>
                    </div>
                    <select class="control-select" id="occasionSelect">
                        <option value="none">No Special Occasion</option>
                        <option value="easter">Easter</option>
                        <option value="christmas">Christmas</option>
                        <option value="thanksgiving">Thanksgiving</option>
                        <option value="birthday">Birthday</option>
                        <option value="wedding">Wedding</option>
                    </select>
                </div>
            </section>

            <!-- Verse Section -->
            <section class="verse-section">
                <div class="verse-card">
                    <div class="verse-content">
                        <div class="verse-header">
                            <div class="verse-time-badge" id="verseTimeBadge">🌅 Morning ESV</div>
                            <div class="verse-translation-badge" id="verseTranslationBadge">ESV</div>
                        </div>
                        <div class="verse-text" id="verseText">
                            "When I remember you upon my bed, and meditate on you in the watches of the night."
                        </div>
                        <div class="verse-reference" id="verseReference">Psalm 63:6</div>
                        <div class="verse-actions">
                            <button class="action-btn" id="favoriteBtn" title="Add to Favorites">
                                <i class="far fa-heart"></i>
                            </button>
                            <button class="action-btn" id="copyBtn" title="Copy Verse">
                                <i class="far fa-copy"></i>
                            </button>
                            <button class="action-btn" id="speakBtn" title="Listen to Verse">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <div class="action-buttons-row">
                        <button class="btn btn-secondary" id="prevVerseBtn">
                            <i class="fas fa-arrow-left"></i> Previous Verse
                        </button>
                        <button class="btn btn-secondary" id="nextVerseBtn">
                            Next Verse <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <div class="action-buttons-row">
                        <button class="btn btn-primary" id="shareBtn">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                        <button class="btn btn-outline" id="setReminderBtn">
                            <i class="fas fa-bell"></i> Set Reminder
                        </button>
                    </div>
                </div>
            </section>

            <!-- Statistics Section -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="stat-number" id="totalReminders">0</div>
                        <div class="stat-label">Total Reminders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-number" id="activeReminders">0</div>
                        <div class="stat-label">Active</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <div class="stat-number" id="completedReminders">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="stat-number" id="dayStreak">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                </div>
            </section>

            <!-- Custom Verses Section -->
            <section class="custom-section">
                <div class="section-header">
                    <h3><i class="fas fa-plus-circle"></i> Custom Verses</h3>
                    <button class="btn btn-outline" id="addCustomVerseBtn">
                        <i class="fas fa-plus"></i> Add New
                    </button>
                </div>
                <div class="custom-form" id="customVerseForm" style="display: none;">
                    <div class="form-grid">
                        <input type="text" class="form-input" id="customVerseText" placeholder="Enter verse text...">
                        <input type="text" class="form-input" id="customVerseReference" placeholder="Enter reference (e.g., John 3:16)">
                        <select class="form-input" id="customVerseTranslation">
                            <option value="ESV">ESV</option>
                            <option value="NIV">NIV</option>
                            <option value="KJV">KJV</option>
                        </select>
                        <div class="modal-actions">
                            <button class="btn btn-secondary" id="cancelCustomVerse">Cancel</button>
                            <button class="btn btn-primary" id="saveCustomVerse">Save Verse</button>
                        </div>
                    </div>
                </div>
                <div class="custom-verses-list" id="customVersesList">
                    <div class="empty-history">
                        <i class="fas fa-book-open" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>No custom verses added yet</p>
                    </div>
                </div>
            </section>

            <!-- Collapsible Sections -->
            <section class="collapsible-section">
                <button class="collapsible-btn" id="reminderManagementBtn">
                    <span><i class="fas fa-bell"></i> Reminder Management</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content" id="reminderManagementContent">
                    <div class="reminder-list" id="activeRemindersList">
                        <div class="empty-reminders">
                            <i class="fas fa-bell-slash" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <p>No active reminders</p>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-primary" id="addNewReminderBtn">
                            <i class="fas fa-plus"></i> Add New Reminder
                        </button>
                    </div>
                </div>
            </section>

            <section class="collapsible-section">
                <button class="collapsible-btn" id="shareHistoryBtn">
                    <span><i class="fas fa-history"></i> Share History</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content" id="shareHistoryContent">
                    <div class="history-list" id="shareHistoryList">
                        <div class="empty-history">
                            <i class="fas fa-share-alt" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <p>No share history yet</p>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-secondary" id="clearShareHistoryBtn">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                    </div>
                </div>
            </section>

            <section class="collapsible-section">
                <button class="collapsible-btn" id="whatsappBroadcastBtn">
                    <span><i class="fab fa-whatsapp"></i> WhatsApp Broadcast Assistant</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapsible-content" id="whatsappBroadcastContent">
                    <div class="broadcast-section">
                        <h4>Broadcast Guide</h4>
                        <div class="broadcast-steps">
                            <div class="broadcast-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>Prepare Your Verse</h4>
                                    <p>Copy the verse text with reference. Recipients will receive clean text with attribution.</p>
                                    <button class="copy-btn" id="copyVerseForBroadcast">
                                        <i class="far fa-copy"></i> "When I remember you upon my bed, and meditate on you in the watches of the night." - Psalm 63:6
                                    </button>
                                </div>
                            </div>
                            <div class="broadcast-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>Open WhatsApp Broadcast</h4>
                                    <p>In WhatsApp, tap the three dots (⋮) → New broadcast</p>
                                </div>
                            </div>
                            <div class="broadcast-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>Select Recipients</h4>
                                    <p>Choose up to 256 contacts from your phone's contact list</p>
                                </div>
                            </div>
                            <div class="broadcast-step">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <h4>Paste and Send</h4>
                                    <p>Paste the verse and add a personal message if desired. Send to all recipients at once.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="contacts-section">
                        <h4>Contact Management</h4>
                        <div class="contacts-list" id="broadcastContactsList">
                            <div class="empty-contacts">
                                <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                <p>No contacts added</p>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn-outline" id="addContactBtn">
                                <i class="fas fa-plus"></i> Add Contact
                            </button>
                            <button class="btn btn-secondary" id="importSampleContactsBtn">
                                <i class="fas fa-download"></i> Import Sample
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Share Modal -->
    <div class="modal" id="shareModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-share-alt"></i> Share Verse</h3>
                <button class="modal-close" id="shareModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="share-type-selection">
                    <button class="share-type-btn active" data-type="text">Text</button>
                    <button class="share-type-btn" data-type="image">Image</button>
                    <button class="share-type-btn" data-type="social">Social Media</button>
                </div>
                <div class="share-options-grid">
                    <div class="share-option" data-platform="whatsapp">
                        <div class="share-icon">
                            <i class="fab fa-whatsapp"></i>
                        </div>
                        <span>WhatsApp</span>
                    </div>
                    <div class="share-option" data-platform="facebook">
                        <div class="share-icon">
                            <i class="fab fa-facebook"></i>
                        </div>
                        <span>Facebook</span>
                    </div>
                    <div class="share-option" data-platform="twitter">
                        <div class="share-icon">
                            <i class="fab fa-twitter"></i>
                        </div>
                        <span>Twitter</span>
                    </div>
                    <div class="share-option" data-platform="instagram">
                        <div class="share-icon">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <span>Instagram</span>
                    </div>
                    <div class="share-option" data-platform="email">
                        <div class="share-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <span>Email</span>
                    </div>
                    <div class="share-option" data-platform="sms">
                        <div class="share-icon">
                            <i class="fas fa-sms"></i>
                        </div>
                        <span>SMS</span>
                    </div>
                    <div class="share-option device-share" data-platform="device">
                        <div class="share-icon">
                            <i class="fas fa-share-alt"></i>
                        </div>
                        <span>Device Share</span>
                    </div>
                    <div class="share-option share-with-link" data-platform="link">
                        <div class="share-icon">
                            <i class="fas fa-link"></i>
                        </div>
                        <span>Copy Link</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Set Reminder Modal -->
    <div class="modal" id="reminderModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-bell"></i> Set Reminder</h3>
                <button class="modal-close" id="reminderModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <input type="text" class="form-input" id="reminderTitle" placeholder="Reminder title (optional)" value="Read Bible Verse">
                    <textarea class="form-input" id="reminderNote" placeholder="Add a note (optional)">Remember to read and reflect on today's verse.</textarea>
                    <input type="datetime-local" class="form-input" id="reminderDateTime">
                    <select class="form-input" id="reminderRepeat">
                        <option value="none">Does not repeat</option>
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="weekdays">Weekdays</option>
                        <option value="weekends">Weekends</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="reminderCancel">Cancel</button>
                    <button class="btn btn-primary" id="reminderSave">Save Reminder</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Contact Modal -->
    <div class="modal" id="contactModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> Add Contact</h3>
                <button class="modal-close" id="contactModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <input type="text" class="form-input" id="contactName" placeholder="Contact Name">
                    <input type="tel" class="form-input" id="contactPhone" placeholder="Phone Number">
                    <input type="email" class="form-input" id="contactEmail" placeholder="Email (optional)">
                    <select class="form-input" id="contactGroup">
                        <option value="general">General</option>
                        <option value="family">Family</option>
                        <option value="friends">Friends</option>
                        <option value="church">Church</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="contactCancel">Cancel</button>
                    <button class="btn btn-primary" id="contactSave">Save Contact</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification" style="display: none;"></div>

    <script>
        // DOM Elements
        const rateButton = document.getElementById('rateButton');
        const ratingModal = document.getElementById('ratingModal');
        const ratingStars = document.querySelectorAll('.rating-star');
        const ratingSubmit = document.getElementById('ratingSubmit');
        const ratingCancel = document.getElementById('ratingCancel');
        const warningModal = document.getElementById('warningModal');
        const warningContinue = document.getElementById('warningContinue');
        const warningLearnMore = document.getElementById('warningLearnMore');
        const themeToggle = document.getElementById('themeToggle');
        const translationSelect = document.getElementById('translationSelect');
        const displayModeSelect = document.getElementById('displayModeSelect');
        const canvasStyleSelect = document.getElementById('canvasStyleSelect');
        const appModeSelect = document.getElementById('appModeSelect');
        const occasionSelect = document.getElementById('occasionSelect');
        const verseText = document.getElementById('verseText');
        const verseReference = document.getElementById('verseReference');
        const verseTimeBadge = document.getElementById('verseTimeBadge');
        const verseTranslationBadge = document.getElementById('verseTranslationBadge');
        const favoriteBtn = document.getElementById('favoriteBtn');
        const copyBtn = document.getElementById('copyBtn');
        const speakBtn = document.getElementById('speakBtn');
        const prevVerseBtn = document.getElementById('prevVerseBtn');
        const nextVerseBtn = document.getElementById('nextVerseBtn');
        const shareBtn = document.getElementById('shareBtn');
        const setReminderBtn = document.getElementById('setReminderBtn');
        const shareModal = document.getElementById('shareModal');
        const shareModalClose = document.getElementById('shareModalClose');
        const shareOptions = document.querySelectorAll('.share-option');
        const reminderModal = document.getElementById('reminderModal');
        const reminderModalClose = document.getElementById('reminderModalClose');
        const reminderCancel = document.getElementById('reminderCancel');
        const reminderSave = document.getElementById('reminderSave');
        const addCustomVerseBtn = document.getElementById('addCustomVerseBtn');
        const customVerseForm = document.getElementById('customVerseForm');
        const cancelCustomVerse = document.getElementById('cancelCustomVerse');
        const saveCustomVerse = document.getElementById('saveCustomVerse');
        const customVersesList = document.getElementById('customVersesList');
        const reminderManagementBtn = document.getElementById('reminderManagementBtn');
        const reminderManagementContent = document.getElementById('reminderManagementContent');
        const shareHistoryBtn = document.getElementById('shareHistoryBtn');
        const shareHistoryContent = document.getElementById('shareHistoryContent');
        const whatsappBroadcastBtn = document.getElementById('whatsappBroadcastBtn');
        const whatsappBroadcastContent = document.getElementById('whatsappBroadcastContent');
        const addNewReminderBtn = document.getElementById('addNewReminderBtn');
        const clearShareHistoryBtn = document.getElementById('clearShareHistoryBtn');
        const copyVerseForBroadcast = document.getElementById('copyVerseForBroadcast');
        const addContactBtn = document.getElementById('addContactBtn');
        const importSampleContactsBtn = document.getElementById('importSampleContactsBtn');
        const contactModal = document.getElementById('contactModal');
        const contactModalClose = document.getElementById('contactModalClose');
        const contactCancel = document.getElementById('contactCancel');
        const contactSave = document.getElementById('contactSave');
        const broadcastContactsList = document.getElementById('broadcastContactsList');
        const activeRemindersList = document.getElementById('activeRemindersList');
        const shareHistoryList = document.getElementById('shareHistoryList');
        const notification = document.getElementById('notification');
        const currentTimeElement = document.getElementById('currentTime');
        const currentTimePeriod = document.getElementById('currentTimePeriod');
        const countdown = document.getElementById('countdown');
        const totalReminders = document.getElementById('totalReminders');
        const activeReminders = document.getElementById('activeReminders');
        const completedReminders = document.getElementById('completedReminders');
        const dayStreak = document.getElementById('dayStreak');
        const scheduleModal = document.getElementById('scheduleModal');
        const scheduleOptions = document.querySelectorAll('.schedule-option');
        const scheduleCancel = document.getElementById('scheduleCancel');
        const scheduleConfirm = document.getElementById('scheduleConfirm');
        const customTimeInput = document.getElementById('customTimeInput');
        const customTime = document.getElementById('customTime');
        const themeModal = document.getElementById('themeModal');
        const themeModalClose = document.getElementById('themeModalClose');
        const themeSelect = document.getElementById('themeSelect');
        const themePreview = document.getElementById('themePreview');
        const applyTheme = document.getElementById('applyTheme');
        const saveThemeImage = document.getElementById('saveThemeImage');
        const shareTypeButtons = document.querySelectorAll('.share-type-btn');
        const periods = document.querySelectorAll('.period');

        // App State
        let appState = {
            currentVerse: {
                text: '"When I remember you upon my bed, and meditate on you in the watches of the night."',
                reference: 'Psalm 63:6',
                translation: 'ESV',
                timePeriod: 'night'
            },
            favorites: [],
            customVerses: [],
            reminders: [],
            shareHistory: [],
            contacts: [],
            statistics: {
                totalReminders: 0,
                activeReminders: 0,
                completedReminders: 0,
                dayStreak: 0,
                viewed: 2,
                shared: 0,
                favorites: 0
            },
            settings: {
                theme: 'dark',
                translation: 'ESV',
                displayMode: 'auto',
                canvasStyle: 'classic',
                appMode: 'general',
                occasion: 'none'
            },
            rating: {
                showButton: true,
                submitted: false
            }
        };

        // Bible Verses Database
        const bibleVerses = {
            morning: [
                { text: '"The steadfast love of the Lord never ceases; his mercies never come to an end; they are new every morning; great is your faithfulness."', reference: 'Lamentations 3:22-23', translation: 'ESV' },
                { text: '"Satisfy us in the morning with your steadfast love, that we may rejoice and be glad all our days."', reference: 'Psalm 90:14', translation: 'ESV' },
                { text: '"Let me hear in the morning of your steadfast love, for in you I trust. Make me know the way I should go, for to you I lift up my soul."', reference: 'Psalm 143:8', translation: 'ESV' }
            ],
            day: [
                { text: '"The Lord is my shepherd; I shall not want. He makes me lie down in green pastures. He leads me beside still waters."', reference: 'Psalm 23:1-2', translation: 'ESV' },
                { text: '"But I will sing of your strength; I will sing aloud of your steadfast love in the morning. For you have been to me a fortress and a refuge in the day of my distress."', reference: 'Psalm 59:16', translation: 'ESV' },
                { text: '"The Lord is my light and my salvation; whom shall I fear? The Lord is the stronghold of my life; of whom shall I be afraid?"', reference: 'Psalm 27:1', translation: 'ESV' }
            ],
            afternoon: [
                { text: '"Come to me, all who labor and are heavy laden, and I will give you rest."', reference: 'Matthew 11:28', translation: 'ESV' },
                { text: '"But they who wait for the Lord shall renew their strength; they shall mount up with wings like eagles; they shall run and not be weary; they shall walk and not faint."', reference: 'Isaiah 40:31', translation: 'ESV' },
                { text: '"I can do all things through him who strengthens me."', reference: 'Philippians 4:13', translation: 'ESV' }
            ],
            evening: [
                { text: '"In peace I will both lie down and sleep; for you alone, O Lord, make me dwell in safety."', reference: 'Psalm 4:8', translation: 'ESV' },
                { text: '"It is in vain that you rise up early and go late to rest, eating the bread of anxious toil; for he gives to his beloved sleep."', reference: 'Psalm 127:2', translation: 'ESV' },
                { text: '"When you lie down, you will not be afraid; when you lie down, your sleep will be sweet."', reference: 'Proverbs 3:24', translation: 'ESV' }
            ],
            night: [
                { text: '"When I remember you upon my bed, and meditate on you in the watches of the night."', reference: 'Psalm 63:6', translation: 'ESV' },
                { text: '"Be still, and know that I am God. I will be exalted among the nations, I will be exalted in the earth!"', reference: 'Psalm 46:10', translation: 'ESV' },
                { text: '"The Lord will keep your going out and your coming in from this time forth and forevermore."', reference: 'Psalm 121:8', translation: 'ESV' }
            ]
        };

        // Initialize the app
        function initApp() {
            loadAppState();
            updateUI();
            setupEventListeners();
            updateTime();
            setInterval(updateTime, 60000); // Update time every minute
            
            // Show warning modal on first load
            setTimeout(() => {
                warningModal.style.display = 'block';
            }, 1000);
            
            // Show rate button after 30 seconds
            setTimeout(() => {
                if (appState.rating.showButton && !appState.rating.submitted) {
                    rateButton.style.display = 'block';
                }
            }, 30000);
        }

        // Load app state from localStorage
        function loadAppState() {
            const savedState = localStorage.getItem('verseCuratorState');
            if (savedState) {
                appState = { ...appState, ...JSON.parse(savedState) };
            }
        }

        // Save app state to localStorage
        function saveAppState() {
            localStorage.setItem('verseCuratorState', JSON.stringify(appState));
        }

        // Update UI based on app state
        function updateUI() {
            // Update verse display
            verseText.textContent = appState.currentVerse.text;
            verseReference.textContent = appState.currentVerse.reference;
            verseTranslationBadge.textContent = appState.currentVerse.translation;
            
            // Update time period badge
            const timePeriod = appState.currentVerse.timePeriod;
            const timeIcons = {
                morning: '🌅',
                day: '☀️',
                afternoon: '🌇',
                evening: '🌆',
                night: '🌙'
            };
            verseTimeBadge.textContent = `${timeIcons[timePeriod]} ${capitalizeFirstLetter(timePeriod)} ${appState.currentVerse.translation}`;
            
            // Update settings controls
            translationSelect.value = appState.settings.translation;
            displayModeSelect.value = appState.settings.displayMode;
            canvasStyleSelect.value = appState.settings.canvasStyle;
            appModeSelect.value = appState.settings.appMode;
            occasionSelect.value = appState.settings.occasion;
            
            // Update statistics
            totalReminders.textContent = appState.statistics.totalReminders;
            activeReminders.textContent = appState.statistics.activeReminders;
            completedReminders.textContent = appState.statistics.completedReminders;
            dayStreak.textContent = appState.statistics.dayStreak;
            
            // Update custom verses list
            updateCustomVersesList();
            
            // Update reminders list
            updateRemindersList();
            
            // Update share history
            updateShareHistory();
            
            // Update contacts list
            updateContactsList();
            
            // Update theme
            document.body.classList.toggle('dark-mode', appState.settings.theme === 'dark');
            
            // Update active time period
            updateActiveTimePeriod();
        }

        // Update active time period indicator
        function updateActiveTimePeriod() {
            const currentPeriod = appState.currentVerse.timePeriod;
            periods.forEach(period => {
                period.classList.toggle('active', period.dataset.period === currentPeriod);
            });
        }

        // Update time display
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            currentTimeElement.textContent = timeString;
            
            // Calculate next time period
            const hours = now.getHours();
            let nextPeriod, nextTime;
            
            if (hours < 5) {
                nextPeriod = 'morning';
                nextTime = '5:00 AM';
            } else if (hours < 12) {
                nextPeriod = 'day';
                nextTime = '12:00 PM';
            } else if (hours < 15) {
                nextPeriod = 'afternoon';
                nextTime = '3:00 PM';
            } else if (hours < 18) {
                nextPeriod = 'evening';
                nextTime = '6:00 PM';
            } else if (hours < 22) {
                nextPeriod = 'night';
                nextTime = '10:00 PM';
            } else {
                nextPeriod = 'morning';
                nextTime = '5:00 AM';
            }
            
            countdown.textContent = `(Next: ${nextTime})`;
            
            // Update current time period if in auto mode
            if (appState.settings.displayMode === 'auto') {
                let currentPeriod;
                if (hours >= 5 && hours < 12) currentPeriod = 'morning';
                else if (hours >= 12 && hours < 15) currentPeriod = 'day';
                else if (hours >= 15 && hours < 18) currentPeriod = 'afternoon';
                else if (hours >= 18 && hours < 22) currentPeriod = 'evening';
                else currentPeriod = 'night';
                
                if (currentPeriod !== appState.currentVerse.timePeriod) {
                    setRandomVerseForTimePeriod(currentPeriod);
                }
                
                currentTimePeriod.textContent = `${timeIcons[currentPeriod]} ${capitalizeFirstLetter(currentPeriod)}`;
            }
        }

        // Set random verse for time period
        function setRandomVerseForTimePeriod(timePeriod) {
            const verses = bibleVerses[timePeriod];
            if (verses && verses.length > 0) {
                const randomIndex = Math.floor(Math.random() * verses.length);
                appState.currentVerse = {
                    ...verses[randomIndex],
                    timePeriod: timePeriod
                };
                updateUI();
                saveAppState();
            }
        }

        // Update custom verses list
        function updateCustomVersesList() {
            if (appState.customVerses.length === 0) {
                customVersesList.innerHTML = `
                    <div class="empty-history">
                        <i class="fas fa-book-open" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>No custom verses added yet</p>
                    </div>
                `;
                return;
            }
            
            customVersesList.innerHTML = appState.customVerses.map((verse, index) => `
                <div class="custom-verse-item">
                    <div class="verse-content">
                        <strong>${verse.text}</strong>
                        <div class="verse-meta">
                            <span>${verse.reference}</span>
                            <span>${verse.translation}</span>
                        </div>
                    </div>
                    <button class="delete-verse" data-index="${index}">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `).join('');
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-verse').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.dataset.index);
                    appState.customVerses.splice(index, 1);
                    updateCustomVersesList();
                    saveAppState();
                    showNotification('Custom verse deleted', 'success');
                });
            });
        }

        // Update reminders list
        function updateRemindersList() {
            const activeReminders = appState.reminders.filter(reminder => !reminder.completed);
            
            if (activeReminders.length === 0) {
                activeRemindersList.innerHTML = `
                    <div class="empty-reminders">
                        <i class="fas fa-bell-slash" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>No active reminders</p>
                    </div>
                `;
                return;
            }
            
            activeRemindersList.innerHTML = activeReminders.map((reminder, index) => `
                <div class="reminder-item">
                    <div class="reminder-content">
                        <div class="reminder-title">${reminder.title}</div>
                        <div class="reminder-details">
                            <span><i class="far fa-clock"></i> ${formatDateTime(reminder.dateTime)}</span>
                            <span><i class="fas fa-redo"></i> ${reminder.repeat === 'none' ? 'No repeat' : capitalizeFirstLetter(reminder.repeat)}</span>
                        </div>
                    </div>
                    <div class="reminder-actions">
                        <button class="reminder-action-btn complete" data-id="${reminder.id}">
                            <i class="fas fa-check"></i>
                        </button>
                        <button class="reminder-action-btn delete" data-id="${reminder.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to reminder action buttons
            document.querySelectorAll('.reminder-action-btn.complete').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.dataset.id;
                    completeReminder(id);
                });
            });
            
            document.querySelectorAll('.reminder-action-btn.delete').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.dataset.id;
                    deleteReminder(id);
                });
            });
        }

        // Update share history
        function updateShareHistory() {
            if (appState.shareHistory.length === 0) {
                shareHistoryList.innerHTML = `
                    <div class="empty-history">
                        <i class="fas fa-share-alt" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>No share history yet</p>
                    </div>
                `;
                return;
            }
            
            shareHistoryList.innerHTML = appState.shareHistory.slice(0, 10).map(share => `
                <div class="history-item">
                    <div class="history-content">
                        <div class="history-verse">${share.verse}</div>
                        <div class="history-details">
                            <span class="history-platform">
                                <i class="fas fa-${getPlatformIcon(share.platform)}"></i> ${share.platform}
                            </span>
                            <span><i class="far fa-clock"></i> ${formatDateTime(share.timestamp)}</span>
                        </div>
                    </div>
                    <div class="history-actions">
                        <button class="history-action-btn reshare" data-verse="${share.verse}" data-reference="${share.reference}">
                            <i class="fas fa-share"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to reshare buttons
            document.querySelectorAll('.history-action-btn.reshare').forEach(button => {
                button.addEventListener('click', function() {
                    const verse = this.dataset.verse;
                    const reference = this.dataset.reference;
                    appState.currentVerse.text = verse;
                    appState.currentVerse.reference = reference;
                    updateUI();
                    shareModal.style.display = 'flex';
                });
            });
        }

        // Update contacts list
        function updateContactsList() {
            if (appState.contacts.length === 0) {
                broadcastContactsList.innerHTML = `
                    <div class="empty-contacts">
                        <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>No contacts added</p>
                    </div>
                `;
                return;
            }
            
            broadcastContactsList.innerHTML = appState.contacts.map(contact => `
                <div class="contact-item">
                    <div class="contact-info">
                        <div class="contact-avatar">${contact.name.charAt(0)}</div>
                        <div class="contact-details">
                            <h4>${contact.name}</h4>
                            <p>${contact.phone}</p>
                        </div>
                    </div>
                    <div class="contact-actions">
                        <button class="contact-action-btn edit" data-id="${contact.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="contact-action-btn delete" data-id="${contact.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to contact action buttons
            document.querySelectorAll('.contact-action-btn.edit').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.dataset.id;
                    editContact(id);
                });
            });
            
            document.querySelectorAll('.contact-action-btn.delete').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.dataset.id;
                    deleteContact(id);
                });
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // Settings controls
            translationSelect.addEventListener('change', function() {
                appState.settings.translation = this.value;
                updateUI();
                saveAppState();
            });
            
            displayModeSelect.addEventListener('change', function() {
                appState.settings.displayMode = this.value;
                updateUI();
                saveAppState();
            });
            
            canvasStyleSelect.addEventListener('change', function() {
                appState.settings.canvasStyle = this.value;
                updateUI();
                saveAppState();
            });
            
            appModeSelect.addEventListener('change', function() {
                appState.settings.appMode = this.value;
                updateUI();
                saveAppState();
            });
            
            occasionSelect.addEventListener('change', function() {
                appState.settings.occasion = this.value;
                updateUI();
                saveAppState();
            });
            
            // Verse actions
            favoriteBtn.addEventListener('click', toggleFavorite);
            copyBtn.addEventListener('click', copyVerse);
            speakBtn.addEventListener('click', speakVerse);
            prevVerseBtn.addEventListener('click', showPreviousVerse);
            nextVerseBtn.addEventListener('click', showNextVerse);
            shareBtn.addEventListener('click', () => shareModal.style.display = 'flex');
            setReminderBtn.addEventListener('click', () => reminderModal.style.display = 'flex');
            
            // Share modal
            shareModalClose.addEventListener('click', () => shareModal.style.display = 'none');
            shareOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const platform = this.dataset.platform;
                    shareVerse(platform);
                });
            });
            
            // Share type selection
            shareTypeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    shareTypeButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    // In a real app, you would update the share options based on type
                });
            });
            
            // Reminder modal
            reminderModalClose.addEventListener('click', () => reminderModal.style.display = 'none');
            reminderCancel.addEventListener('click', () => reminderModal.style.display = 'none');
            reminderSave.addEventListener('click', saveReminder);
            
            // Custom verses
            addCustomVerseBtn.addEventListener('click', () => customVerseForm.style.display = 'block');
            cancelCustomVerse.addEventListener('click', () => customVerseForm.style.display = 'none');
            saveCustomVerse.addEventListener('click', saveCustomVerseHandler);
            
            // Collapsible sections
            reminderManagementBtn.addEventListener('click', toggleCollapsible.bind(null, reminderManagementBtn, reminderManagementContent));
            shareHistoryBtn.addEventListener('click', toggleCollapsible.bind(null, shareHistoryBtn, shareHistoryContent));
            whatsappBroadcastBtn.addEventListener('click', toggleCollapsible.bind(null, whatsappBroadcastBtn, whatsappBroadcastContent));
            
            // Additional buttons
            addNewReminderBtn.addEventListener('click', () => reminderModal.style.display = 'flex');
            clearShareHistoryBtn.addEventListener('click', clearShareHistory);
            copyVerseForBroadcast.addEventListener('click', copyVerseForBroadcastHandler);
            addContactBtn.addEventListener('click', () => contactModal.style.display = 'flex');
            importSampleContactsBtn.addEventListener('click', importSampleContacts);
            
            // Contact modal
            contactModalClose.addEventListener('click', () => contactModal.style.display = 'none');
            contactCancel.addEventListener('click', () => contactModal.style.display = 'none');
            contactSave.addEventListener('click', saveContact);
            
            // Time period selection
            periods.forEach(period => {
                period.addEventListener('click', function() {
                    const timePeriod = this.dataset.period;
                    setRandomVerseForTimePeriod(timePeriod);
                });
            });
            
            // Schedule modal
            scheduleOptions.forEach(option => {
                option.addEventListener('click', function() {
                    scheduleOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    
                    if (this.dataset.time === 'custom') {
                        customTimeInput.style.display = 'block';
                    } else {
                        customTimeInput.style.display = 'none';
                    }
                });
            });
            
            scheduleCancel.addEventListener('click', () => scheduleModal.style.display = 'none');
            scheduleConfirm.addEventListener('click', confirmSchedule);
            
            // Theme modal
            themeModalClose.addEventListener('click', () => themeModal.style.display = 'none');
            applyTheme.addEventListener('click', applyThemeHandler);
            saveThemeImage.addEventListener('click', saveThemeImageHandler);
            themeSelect.addEventListener('change', updateThemePreview);
            
            // Rating modal
            rateButton.addEventListener('click', () => ratingModal.style.display = 'block');
            ratingCancel.addEventListener('click', () => ratingModal.style.display = 'none');
            ratingSubmit.addEventListener('click', submitRating);
            
            ratingStars.forEach(star => {
                star.addEventListener('click', function() {
                    const rating = parseInt(this.dataset.rating);
                    setRating(rating);
                });
                
                star.addEventListener('mouseover', function() {
                    const rating = parseInt(this.dataset.rating);
                    highlightStars(rating);
                });
            });
            
            document.querySelector('.rating-stars').addEventListener('mouseleave', function() {
                const currentRating = document.querySelector('.rating-star.active')?.dataset.rating || 0;
                highlightStars(parseInt(currentRating));
            });
            
            // Warning modal
            warningContinue.addEventListener('click', () => warningModal.style.display = 'none');
            warningLearnMore.addEventListener('click', () => {
                warningModal.style.display = 'none';
                showNotification('Visit our website for more information', 'info');
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === shareModal) {
                    shareModal.style.display = 'none';
                }
                if (event.target === reminderModal) {
                    reminderModal.style.display = 'none';
                }
                if (event.target === contactModal) {
                    contactModal.style.display = 'none';
                }
                if (event.target === ratingModal) {
                    ratingModal.style.display = 'none';
                }
                if (event.target === warningModal) {
                    warningModal.style.display = 'none';
                }
                if (event.target === scheduleModal) {
                    scheduleModal.style.display = 'none';
                }
                if (event.target === themeModal) {
                    themeModal.style.display = 'none';
                }
            });
        }

        // Toggle theme
        function toggleTheme() {
            appState.settings.theme = appState.settings.theme === 'light' ? 'dark' : 'light';
            document.body.classList.toggle('dark-mode', appState.settings.theme === 'dark');
            saveAppState();
        }

        // Toggle favorite
        function toggleFavorite() {
            const isFavorite = appState.favorites.some(fav => 
                fav.text === appState.currentVerse.text && 
                fav.reference === appState.currentVerse.reference
            );
            
            if (isFavorite) {
                appState.favorites = appState.favorites.filter(fav => 
                    !(fav.text === appState.currentVerse.text && 
                    fav.reference === appState.currentVerse.reference)
                );
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
                showNotification('Removed from favorites', 'success');
                appState.statistics.favorites--;
            } else {
                appState.favorites.push({...appState.currentVerse});
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
                showNotification('Added to favorites', 'success');
                appState.statistics.favorites++;
            }
            
            saveAppState();
        }

        // Copy verse
        function copyVerse() {
            const verseToCopy = `${appState.currentVerse.text} - ${appState.currentVerse.reference}`;
            navigator.clipboard.writeText(verseToCopy).then(() => {
                showNotification('Verse copied to clipboard', 'success');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = verseToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('Verse copied to clipboard', 'success');
            });
        }

        // Speak verse
        function speakVerse() {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance();
                utterance.text = `${appState.currentVerse.text} ${appState.currentVerse.reference}`;
                utterance.rate = 0.8;
                utterance.pitch = 1;
                window.speechSynthesis.speak(utterance);
                showNotification('Reading verse aloud', 'info');
            } else {
                showNotification('Text-to-speech not supported in your browser', 'error');
            }
        }

        // Show previous verse
        function showPreviousVerse() {
            const currentTimePeriod = appState.currentVerse.timePeriod;
            const verses = bibleVerses[currentTimePeriod];
            if (verses && verses.length > 1) {
                const currentIndex = verses.findIndex(verse => 
                    verse.text === appState.currentVerse.text && 
                    verse.reference === appState.currentVerse.reference
                );
                
                let newIndex = currentIndex - 1;
                if (newIndex < 0) newIndex = verses.length - 1;
                
                appState.currentVerse = {
                    ...verses[newIndex],
                    timePeriod: currentTimePeriod
                };
                updateUI();
                saveAppState();
            }
        }

        // Show next verse
        function showNextVerse() {
            const currentTimePeriod = appState.currentVerse.timePeriod;
            const verses = bibleVerses[currentTimePeriod];
            if (verses && verses.length > 1) {
                const currentIndex = verses.findIndex(verse => 
                    verse.text === appState.currentVerse.text && 
                    verse.reference === appState.currentVerse.reference
                );
                
                let newIndex = currentIndex + 1;
                if (newIndex >= verses.length) newIndex = 0;
                
                appState.currentVerse = {
                    ...verses[newIndex],
                    timePeriod: currentTimePeriod
                };
                updateUI();
                saveAppState();
            }
        }

        // Share verse
        function shareVerse(platform) {
            const verseText = appState.currentVerse.text;
            const verseReference = appState.currentVerse.reference;
            const shareText = `${verseText} - ${verseReference}`;
            
            // Add to share history
            appState.shareHistory.unshift({
                verse: verseText,
                reference: verseReference,
                platform: platform,
                timestamp: new Date().toISOString()
            });
            
            // Update statistics
            appState.statistics.shared++;
            
            // Simulate sharing based on platform
            let message = '';
            switch (platform) {
                case 'whatsapp':
                    message = `Check out this Bible verse: ${shareText}`;
                    // In a real app, you would use the WhatsApp API
                    break;
                case 'facebook':
                    message = `Shared Bible verse: ${shareText}`;
                    // In a real app, you would use the Facebook API
                    break;
                case 'twitter':
                    message = `Bible verse: ${shareText}`;
                    // In a real app, you would use the Twitter API
                    break;
                case 'instagram':
                    message = `Bible verse of the day: ${shareText}`;
                    // In a real app, you would create an image share
                    break;
                case 'email':
                    message = `Subject: Bible Verse\n\n${shareText}`;
                    // In a real app, you would use the mailto: protocol
                    break;
                case 'sms':
                    message = `Bible verse: ${shareText}`;
                    // In a real app, you would use the SMS API
                    break;
                case 'device':
                    // In a real app, you would use the Web Share API
                    if (navigator.share) {
                        navigator.share({
                            title: 'Bible Verse',
                            text: shareText
                        }).then(() => {
                            showNotification('Verse shared successfully', 'success');
                        }).catch(() => {
                            showNotification('Share cancelled', 'info');
                        });
                    } else {
                        showNotification('Device sharing not supported', 'error');
                    }
                    return;
                case 'link':
                    navigator.clipboard.writeText(shareText).then(() => {
                        showNotification('Verse copied to clipboard', 'success');
                    });
                    return;
            }
            
            showNotification(`Verse shared via ${platform}`, 'success');
            shareModal.style.display = 'none';
            saveAppState();
            updateUI();
        }

        // Save reminder
        function saveReminder() {
            const title = document.getElementById('reminderTitle').value || 'Read Bible Verse';
            const note = document.getElementById('reminderNote').value || '';
            const dateTime = document.getElementById('reminderDateTime').value;
            const repeat = document.getElementById('reminderRepeat').value;
            
            if (!dateTime) {
                showNotification('Please select a date and time', 'error');
                return;
            }
            
            const reminder = {
                id: Date.now().toString(),
                title,
                note,
                dateTime,
                repeat,
                completed: false
            };
            
            appState.reminders.push(reminder);
            appState.statistics.totalReminders++;
            appState.statistics.activeReminders++;
            
            showNotification('Reminder set successfully', 'success');
            reminderModal.style.display = 'none';
            saveAppState();
            updateUI();
        }

        // Complete reminder
        function completeReminder(id) {
            const reminder = appState.reminders.find(r => r.id === id);
            if (reminder) {
                reminder.completed = true;
                appState.statistics.activeReminders--;
                appState.statistics.completedReminders++;
                showNotification('Reminder completed', 'success');
                saveAppState();
                updateUI();
            }
        }

        // Delete reminder
        function deleteReminder(id) {
            const reminderIndex = appState.reminders.findIndex(r => r.id === id);
            if (reminderIndex !== -1) {
                const reminder = appState.reminders[reminderIndex];
                appState.reminders.splice(reminderIndex, 1);
                appState.statistics.totalReminders--;
                if (!reminder.completed) {
                    appState.statistics.activeReminders--;
                } else {
                    appState.statistics.completedReminders--;
                }
                showNotification('Reminder deleted', 'success');
                saveAppState();
                updateUI();
            }
        }

        // Save custom verse
        function saveCustomVerseHandler() {
            const text = document.getElementById('customVerseText').value;
            const reference = document.getElementById('customVerseReference').value;
            const translation = document.getElementById('customVerseTranslation').value;
            
            if (!text || !reference) {
                showNotification('Please enter both verse text and reference', 'error');
                return;
            }
            
            const customVerse = {
                text,
                reference,
                translation
            };
            
            appState.customVerses.push(customVerse);
            showNotification('Custom verse added', 'success');
            customVerseForm.style.display = 'none';
            
            // Clear form
            document.getElementById('customVerseText').value = '';
            document.getElementById('customVerseReference').value = '';
            
            saveAppState();
            updateUI();
        }

        // Toggle collapsible section
        function toggleCollapsible(button, content) {
            const isActive = button.classList.contains('active');
            
            // Close all collapsible sections
            document.querySelectorAll('.collapsible-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.collapsible-content').forEach(cont => {
                cont.style.display = 'none';
            });
            
            // Open this section if it wasn't active
            if (!isActive) {
                button.classList.add('active');
                content.style.display = 'block';
            }
        }

        // Clear share history
        function clearShareHistory() {
            appState.shareHistory = [];
            showNotification('Share history cleared', 'success');
            saveAppState();
            updateUI();
        }

        // Copy verse for broadcast
        function copyVerseForBroadcastHandler() {
            const verseToCopy = `"${appState.currentVerse.text}" - ${appState.currentVerse.reference}`;
            navigator.clipboard.writeText(verseToCopy).then(() => {
                const button = copyVerseForBroadcast;
                button.innerHTML = '<i class="fas fa-check"></i> Copied!';
                button.classList.add('success');
                showNotification('Verse copied for broadcast', 'success');
                
                setTimeout(() => {
                    button.innerHTML = '<i class="far fa-copy"></i> "' + appState.currentVerse.text + '" - ' + appState.currentVerse.reference;
                    button.classList.remove('success');
                }, 2000);
            });
        }

        // Save contact
        function saveContact() {
            const name = document.getElementById('contactName').value;
            const phone = document.getElementById('contactPhone').value;
            const email = document.getElementById('contactEmail').value;
            const group = document.getElementById('contactGroup').value;
            
            if (!name || !phone) {
                showNotification('Please enter at least name and phone number', 'error');
                return;
            }
            
            const contact = {
                id: Date.now().toString(),
                name,
                phone,
                email,
                group
            };
            
            appState.contacts.push(contact);
            showNotification('Contact added successfully', 'success');
            contactModal.style.display = 'none';
            
            // Clear form
            document.getElementById('contactName').value = '';
            document.getElementById('contactPhone').value = '';
            document.getElementById('contactEmail').value = '';
            
            saveAppState();
            updateUI();
        }

        // Edit contact
        function editContact(id) {
            // In a real app, you would populate the form with contact data
            showNotification('Edit contact feature coming soon', 'info');
        }

        // Delete contact
        function deleteContact(id) {
            const contactIndex = appState.contacts.findIndex(c => c.id === id);
            if (contactIndex !== -1) {
                appState.contacts.splice(contactIndex, 1);
                showNotification('Contact deleted', 'success');
                saveAppState();
                updateUI();
            }
        }

        // Import sample contacts
        function importSampleContacts() {
            const sampleContacts = [
                { id: '1', name: 'John Smith', phone: '+1234567890', email: 'john@example.com', group: 'family' },
                { id: '2', name: 'Sarah Johnson', phone: '+1234567891', email: 'sarah@example.com', group: 'friends' },
                { id: '3', name: 'Pastor Michael', phone: '+1234567892', email: 'pastor@church.com', group: 'church' }
            ];
            
            appState.contacts = [...appState.contacts, ...sampleContacts];
            showNotification('Sample contacts imported', 'success');
            saveAppState();
            updateUI();
        }

        // Confirm schedule
        function confirmSchedule() {
            const selectedOption = document.querySelector('.schedule-option.active');
            if (!selectedOption) {
                showNotification('Please select a schedule option', 'error');
                return;
            }
            
            const scheduleType = selectedOption.dataset.time;
            let scheduleTime;
            
            if (scheduleType === 'custom') {
                scheduleTime = document.getElementById('customTime').value;
                if (!scheduleTime) {
                    showNotification('Please select a custom time', 'error');
                    return;
                }
            } else if (scheduleType === 'now') {
                scheduleTime = 'immediately';
            } else {
                scheduleTime = scheduleType;
            }
            
            showNotification(`Verse scheduled for ${scheduleTime}`, 'success');
            scheduleModal.style.display = 'none';
        }

        // Apply theme
        function applyThemeHandler() {
            const selectedTheme = themeSelect.value;
            appState.settings.canvasStyle = selectedTheme;
            showNotification(`Theme changed to ${selectedTheme}`, 'success');
            themeModal.style.display = 'none';
            updateUI();
            saveAppState();
        }

        // Save theme as image
        function saveThemeImageHandler() {
            showNotification('Theme image saved to gallery', 'success');
            // In a real app, you would generate and save an image
        }

        // Update theme preview
        function updateThemePreview() {
            const selectedTheme = themeSelect.value;
            // In a real app, you would update the canvas preview
        }

        // Set rating
        function setRating(rating) {
            ratingStars.forEach(star => {
                const starRating = parseInt(star.dataset.rating);
                star.classList.toggle('active', starRating <= rating);
            });
        }

        // Highlight stars
        function highlightStars(rating) {
            ratingStars.forEach(star => {
                const starRating = parseInt(star.dataset.rating);
                star.classList.toggle('active', starRating <= rating);
            });
        }

        // Submit rating
        function submitRating() {
            const activeStar = document.querySelector('.rating-star.active');
            if (!activeStar) {
                showNotification('Please select a rating', 'error');
                return;
            }
            
            const rating = parseInt(activeStar.dataset.rating);
            const comment = document.querySelector('.rating-comment').value;
            
            // In a real app, you would send this to a server
            console.log('Rating submitted:', { rating, comment });
            
            appState.rating.submitted = true;
            appState.rating.showButton = false;
            rateButton.style.display = 'none';
            
            showNotification('Thank you for your rating!', 'success');
            ratingModal.style.display = 'none';
            saveAppState();
        }

        // Show notification
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = 'notification';
            notification.classList.add(type);
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.style.animation = '';
                }, 300);
            }, 3000);
        }

        // Utility functions
        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }

        function formatDateTime(dateTimeString) {
            const date = new Date(dateTimeString);
            return date.toLocaleString([], { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit', 
                minute: '2-digit'
            });
        }

        function getPlatformIcon(platform) {
            const icons = {
                whatsapp: 'whatsapp',
                facebook: 'facebook-f',
                twitter: 'twitter',
                instagram: 'instagram',
                email: 'envelope',
                sms: 'comment',
                device: 'share-alt',
                link: 'link'
            };
            return icons[platform] || 'share-alt';
        }

        const timeIcons = {
            morning: '🌅',
            day: '☀️',
            afternoon: '🌇',
            evening: '🌆',
            night: '🌙'
        };

        // Initialize the app
        initApp();
    </script>
</body>
</html>
